{"name":"Garanti Bankası ve EST destekleyen bankalar (İş Bankası, Akbank, Finansbank, Halk Bankası ve Anadolubank) için Sanal Pos sınıfları.","tagline":"Sanalpos uygulamaları","body":"#Garanti ve Est Sanal Pos\r\n-------------------------\r\n\r\nGaranti Bankası ve EST destekleyen bankalar (İş Bankası, Akbank, Finansbank, Halk Bankası ve Anadolubank) için Sanal Pos sınıfları.\r\n\r\nŞu an sadece normal API için uygulamaları bulunuyor. 3D uygulamaları şu an bulunmamaktadır.\r\n\r\n#Kurulum\r\nComposer ile\r\nAşağıdaki şekilde bir composer.json dosyası yaratıp php composer.phar install komutu ile kurulum yapılabilir. Veya var olan composer.json dosyasına eklenebilir.\r\n```json\r\n{\r\n    \"require\": {\r\n        \"defiant/sanalpos\": \"dev-master\"\r\n    }\r\n}\r\n```\r\n\r\nDaha sonra proje içine aşağı şekilde autoload yapılabilir.\r\n```php\r\n<?php\r\nrequire 'vendor/autoload.php';\r\n```\r\n\r\n## EST (İş Bankası, Akbank, Finansbank, Halk Bankası ve Anadolubank sanal pos'ları)\r\n\r\nEst için ```SanalPosEst``` sınıfını kullanıyoruz.\r\nObjeyi şu parametreler ile yaratıyoruz.\r\n- Banka: Sanal pos'u kullanılmak istenen banka (isbank, akbank, finansbank, halkbank, anadolubank)\r\n- clientId - Banka tarafından verilen clientId\r\n- username - Banka tarafından verilen username\r\n- password - Banka tarafında verilen password\r\n\r\nDaha sonra setCard metodu ile card bilgilerini giriyoruz\r\n('kart numarası', 'son kullanma ay', 'son kullanma yıl', 'Cvv numarası')\r\n\r\nÜçüncü adım ise sipariş bilgilerinin girilmesi\r\n- Sipariş Numarası (her sipariş için sistemde farklı bir 'id' olması gerekiyor. Aynı id ile mükerrer siparişler hata veriyor)\r\n- Siparişi verenin email adresi (Bazı bankalarda bu alan mecburi değil, bu gibi durumlarda geçerli herhangi bir email adresi gönderilebilir.)\r\n- Sipariş tutarı (100 TL, 100.25 (Yüz lira 25 kuruş gibi) EST sisteminde kuruşlar için virgül veya nokta kullanılabilir (100.25'de 100,25 aynı)\r\n- Taksit tutarı: Kaç taksit yapılacaksa o değer. Ğeşin satışlar için boş bırakılabilir.\r\n\r\nTest modu için setMode metodu 'TEST' parametresi ile kullanılır. Bu parametre kullanılmaz ise veya başka bir değer verilirse gerçek işlem yapılır.\r\n\r\nSon olarak ```pay``` metodu ile provizyon alınır. pay metoduna TRUE parametresi verilirse PreAuth (önotorisazyon) işlemi yapılır aksi takdirde Auth (satış) işlemi yapılır.\r\n\r\n### Satış (Auth veya PreAuth)\r\nTest verileri ile örnek kullanım:\r\n```php\r\n$est = new \\SanalPos\\Est\\SanalPosEst('isbank', '700100000', 'ISBANKAPI', 'ISBANK07');\r\n$est->setCard('4508034508034509', '12', '16', '000');\r\n$est->setOrder('deneme123', 'test@test.com', '1');\r\n$est->setMode('TEST');\r\n\r\n$result = new \\SanalPos\\Est\\SanalPosResponseEst($est->pay());\r\nvar_dump($result);\r\n```\r\n\r\n### Ön Otorizasyon Kapama (PostAuth)\r\nPreAuth ile açılan siparişlerin kapatılmasında kullanılır. EST sisteminde setCard ve setOrder metodlarının kullanılmasına gerek yoktur.\r\npostAuth tek parametre olarak preAuth yapılmış siparişin numarasına ihtiyaç duyar.\r\n```php\r\n$est = new \\SanalPos\\Est\\SanalPosEst('isbank', '700100000', 'ISBANKAPI', 'ISBANK07');\r\n$est->postAuth('deneme1234');\r\n```\r\n\r\n### İptal (Void) işlemi\r\nİptal, bir işlemin gün sonundan önce iptal edilmesi demektir. Gün sonu işleminden sonra refund kullanılması gerekir.\r\ncancel metodu tek parametre olarak siparişin numarasına ihtiyaç duyar.\r\n```php\r\n$est = new \\SanalPos\\Est\\SanalPosEst('isbank', '700100000', 'ISBANKAPI', 'ISBANK07');\r\n$est->cancel('deneme1234');\r\n```\r\n\r\n### İade (Refund)\r\nSiparişin bir kısmının ve tamamının iptal edilmesi. İade işlemi ancak gün sonundan sonra yapılabilir.\r\nredund metodu parametre olarak preAuth yapılmış siparişin numarasına ve opsiyonel miktara ihtiyaç duyar. Eğer opsiyonel miktar belirtilmez ise, tüm miktar iade edilir.\r\n```php\r\n$est = new \\SanalPos\\Est\\SanalPosEst('isbank', '700100000', 'ISBANKAPI', 'ISBANK07');\r\n$est->refund('deneme1234', '25') // Siparişin 25 lirasını iade et.\r\n// veya\r\n$est->refund('deneme1234') // Siparişin tümünü iade et.\r\n```\r\n\r\n### Cevaplar\r\nCevaplar XML şeklinde alınır \\SanalPos\\Est\\SanalPosResponseEst nesnesi bu cevaplar için ortak bir sınıf olarak kullanılanabilir.\r\nÜç metodu var\r\nsuccess: İşlem başarılı ise true aksi takdirde false döner\r\nerrors: Alınan hata mesajı döner\r\nresponse: Alınan XML cevabı olduğu gibi döndürür.\r\n\r\n## Garanti Bankası\r\nGaranti sınıfı da yukarıdakine benzer şekilde kullanılmaktadır.\r\nFark olarak banka ismi gerekmez ama banka tarafından verilen bilgiler girilir. Bunlar sırasıyla;\r\n- merchantId,\r\n- terminalId,\r\n- userId,\r\n- password,\r\n- provisionUser\r\n\r\nBunun dışındaki diğer işlemler yukarıdakiler ile aynıdır. Fakat Garanti bankasında her işlemden önce setCard ve setOrder metodları kullanılmalıdır. Bunun sebebi Garanti bankasının bu verileri Hash verisini hesaplamakta kullanılmasıdır.\r\n\r\n```php\r\n// Sınıfı initialize et\r\n$garantiPos = new \\SanalPos\\Garanti\\SanalPosGaranti('7000679', '30691297', 'PROVAUT', '123qweASD', 'PROVAUT');\r\n\r\n// Kredi kartı Bilgilerini set et\r\n$garantiPos->setCard('4282209027132016', '05', '15', '232');\r\n\r\n// Sipariş verilerini set et\r\n// Mecburi alanlar 'orderId', 'customer email', 'order total'\r\n$garantiPos->setOrder('deneme23', 'test@test.com', '1');\r\n\r\n// Test sunucusunda deneme yapmak için mode'u 'TEST' olarak ayarlıyoruz.\r\n$garantiPos->setMode('TEST');\r\n\r\n// pay() metodu ile ödemeyi gönderiyoruz.\r\n$result = new \\SanalPos\\Garanti\\SanalPosReponseGaranti($garantiPos->pay());\r\n\r\n// Eğer sorgu onaylandı ise success metodu true döndürüyor\r\n// aksi halde errors() metodunda hata mesajı var.\r\nif($result->success()){\r\n    // transaction successful\r\n}else{\r\n    //transaction failed\r\n    var_dump($result->errors());\r\n}\r\n```\r\n\r\n##TODO\r\nİlk planda;\r\n- Base sınıf içinde çeşitli kontrollerin eklenmesi.","google":"UA-2862188-13","note":"Don't delete this file! It's used internally to help with page regeneration."}